(e=>{e.querySelectorAll('.footnotes > ol > li[id^="fn"], #refs > div[id^="ref-"]').forEach((t=>{const r=`a[href="#${t.id}"]`,n=e.querySelector(`${r} > sup, sup > ${r}, .citation > ${r}`);if(!n)return;const s=n.parentNode;("A"===n.tagName?n:s).removeAttribute("href");const i=e.createElement("div");i.className="side side-right",/^fn/.test(t.id)?(i.innerHTML=t.innerHTML,i.firstElementChild.insertAdjacentHTML("afterbegin",`<span class="bg-number">${n.innerText}</span> `),i.querySelector('a[href^="#fnref"]')?.remove()):i.innerHTML=t.outerHTML,s.after(i),s.classList.add("note-ref"),t.remove()})),e.querySelectorAll(".footnotes, #refs").forEach((e=>{/^\s*$/.test(e.innerText)&&e.remove()})),e.getElementById("TOC")?.classList.add("side","side-left")})(document);